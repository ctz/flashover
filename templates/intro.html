$def with (job, status, meta, stats)
$var title: overview

$def desc_link(icon, name_single, name_plural, key):
  $if len(meta[key]):
    <i class="icon-$icon"></i> ${len(meta[key])} ${plural(meta[key], name_single, name_plural)}
  $else:
    <i class="icon-$icon"></i> No ${plural(0, name_single, name_plural)}

$code:
  def shapes_link():
    return desc_link('asterisk', 'shape', 'shapes', 'shapes')
  
  def images_link():
    return desc_link('picture', 'image', 'images', 'images')

  def sounds_link():
    return desc_link('volume-up', 'sound', 'sounds', 'sounds')

  def binaries_link():
    return desc_link('file', 'binary', 'binaries', 'binaries')
    
$def nav_entry(content, key):
  $if len(meta[key]):
    <li><a href="/$key/$job">$:content</a></li>
  $else:
    <li><span class="disabled">$:content</span></li>

<div class="content">
  <div class="row">
    <div class="span2">
      <ul class="nav nav-list">
        <li class="active"><a href="#overview"><i class="icon-home"></i> Overview</a></li>
        <hr/>
        
        <li class="nav-header">
          Assets
        </li>
        $:nav_entry(shapes_link(), 'shapes')
        $:nav_entry(images_link(), 'images')
        $:nav_entry(sounds_link(), 'sounds')
        $:nav_entry(binaries_link(), 'binaries')
        
        <hr/>
        <li class="nav-header">
          Structure
        </li>
        <li><a href="/timeline/$job"><i class="icon-forward"></i> Timeline</a></li>
        <li><a href="/scripts/$job"><i class="icon-list"></i> Scripts</a></li>
        <li><a href="/metadata/$job"><i class="icon-tags"></i> Metadata</a></li>
        
        <hr/>
        
        <li><a href="/input-file/$job"><i class="icon-download-alt"></i> Download SWF</a></li>
        <li><span class="disabled" title="input file size"><i class="icon-resize-full"></i> $filesize(meta['filesize'])</span></li>
        <li><span class="disabled" title="processing time"><i class="icon-time"></i> $duration(meta['parse_time'])</span></li>
        <li><span class="disabled" title="time until deletion"><i class="icon-trash"></i> $duration(stats['timestamp'] + 60 * 60 - time_now)</span></li>
        
      </ul>
    </div>
    $code:
      pix = 8
    <div class="span4 pull-center">
      <ul class="thumbnails thumbnails-compact">
      $for shp in meta['shapes'][:pix]:
        <li>
          <div class="thumbnail th54">
            <img src="/image-thumb-svg/$job/$shp['id']/44" />
          </div>
        </li>
      $for i in range(pix - min(pix, len(meta['shapes']))):
        <li>
          <div class="thumbnail disabled th54"></div>
        </li>
      $if meta['shapes']:
        <a href="/shapes/$job" class="btn btn-large">
          $:shapes_link()
        </a>
      $else:
        <a class="btn btn-large disabled">
          $:shapes_link()
        </a>
      </ul>
    </div>
    
    <div class="span4 pull-center">
      <ul class="thumbnails thumbnails-compact">
      $for img in meta['images'][:pix]:
        <li>
          <div class="thumbnail th54">
            <img src="/image-thumb/$job/$img['id']/44" />
          </div>
        </li>
      $for i in range(pix - min(pix, len(meta['images']))):
        <li>
          <div class="thumbnail disabled th54"></div>
        </li>
      $if meta['images']:
        <a href="/images/$job" class="btn btn-large">
          $:images_link()
        </a>
      $else:
        <a class="btn btn-large disabled">
          $:images_link()
        </a>
      </ul>
    </div>
    
    <div class="span4 pull-center">
      <ul class="thumbnails thumbnails-compact">
      $for img in meta['sounds'][:pix]:
        <li>
          <div class="thumbnail th54">
            <i class="icon-volume-up icon-thumbnail"></i>
          </div>
        </li>
      $for i in range(pix - min(pix, len(meta['sounds']))):
        <li>
          <div class="thumbnail disabled th54"></div>
        </li>
      $if meta['sounds']:
        <a href="/sounds/$job" class="btn btn-large">
          $:sounds_link()
        </a>
      $else:
        <a class="btn btn-large disabled">
          $:sounds_link()
        </a>
      </ul>
    </div>
    
    <div class="span4 pull-center">
      <ul class="thumbnails thumbnails-compact">
      $for img in meta['binaries'][:pix]:
        <li>
          <div class="thumbnail th54">
            <i class="icon-file icon-thumbnail"></i>
          </div>
        </li>
      $for i in range(pix - min(pix, len(meta['binaries']))):
        <li>
          <div class="thumbnail disabled th54"></div>
        </li>
      $if meta['binaries']:
        <a href="/binaries/$job" class="btn btn-large">
          $:binaries_link()
        </a>
      $else:
        <a class="btn btn-large disabled">
          $:binaries_link()
        </a>
      </ul>
    </div>
  </div>
    
</div>
